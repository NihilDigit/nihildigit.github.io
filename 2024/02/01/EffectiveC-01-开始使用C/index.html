<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="在这一章中，您将开发您的第一个C程序：传统的“Hello, world!”程序。我将带您了解这个简单程序的各个方面，以及如何编译和运行C程序。 然后，我将讨论一些编辑器和编译器选项，并列出您在编写C代码时将快速熟悉的常见可移植性问题。 开发您的第一个C程序学习C编程的最佳方式是开始编写C程序，传统上，我们从“Hello, world!”开始。要编写这个程序，您需要一个文本编辑器或集成开发环境（ID">
<meta property="og:type" content="article">
<meta property="og:title" content="EffectiveC_01_开始使用C">
<meta property="og:url" content="https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/index.html">
<meta property="og:site_name" content="Digital Odyssey">
<meta property="og:description" content="在这一章中，您将开发您的第一个C程序：传统的“Hello, world!”程序。我将带您了解这个简单程序的各个方面，以及如何编译和运行C程序。 然后，我将讨论一些编辑器和编译器选项，并列出您在编写C代码时将快速熟悉的常见可移植性问题。 开发您的第一个C程序学习C编程的最佳方式是开始编写C程序，传统上，我们从“Hello, world!”开始。要编写这个程序，您需要一个文本编辑器或集成开发环境（ID">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-02-01T14:22:24.000Z">
<meta property="article:modified_time" content="2024-02-01T14:26:13.429Z">
<meta property="article:author" content="NihilDigit">
<meta property="article:tag" content="CS">
<meta property="article:tag" content="book">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.png">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>EffectiveC_01_开始使用C</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/NihilDigit">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/02/02/EffectiveC-02-%E5%AF%B9%E8%B1%A1%E3%80%81%E5%87%BD%E6%95%B0%E5%92%8C%E7%B1%BB%E5%9E%8B/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/02/01/EffectiveC-00-%E5%BC%95%E8%A8%80/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&text=EffectiveC_01_开始使用C"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&title=EffectiveC_01_开始使用C"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&is_video=false&description=EffectiveC_01_开始使用C"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=EffectiveC_01_开始使用C&body=Check out this article: https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&title=EffectiveC_01_开始使用C"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&title=EffectiveC_01_开始使用C"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&title=EffectiveC_01_开始使用C"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&title=EffectiveC_01_开始使用C"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&name=EffectiveC_01_开始使用C&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&t=EffectiveC_01_开始使用C"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E6%82%A8%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAC%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.</span> <span class="toc-text">开发您的第一个C程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%92%8C%E8%BF%90%E8%A1%8C%E6%82%A8%E7%9A%84%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.</span> <span class="toc-text">编译和运行您的程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E5%A4%84%E7%90%86%E6%8C%87%E4%BB%A4"><span class="toc-number">3.</span> <span class="toc-text">预处理指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E5%87%BD%E6%95%B0"><span class="toc-number">4.</span> <span class="toc-text">主函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-number">5.</span> <span class="toc-text">检查函数返回值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%BE%93%E5%87%BA"><span class="toc-number">6.</span> <span class="toc-text">格式化输出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E5%99%A8%E5%92%8C%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">7.</span> <span class="toc-text">编辑器和集成开发环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%99%A8"><span class="toc-number">8.</span> <span class="toc-text">编译器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%80%A7"><span class="toc-number">9.</span> <span class="toc-text">可移植性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">10.</span> <span class="toc-text">总结</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        EffectiveC_01_开始使用C
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">NihilDigit</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-02-01T14:22:24.000Z" class="dt-published" itemprop="datePublished">2024-02-01</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CS/" rel="tag">CS</a>, <a class="p-category" href="/tags/book/" rel="tag">book</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>在这一章中，您将开发您的第一个C程序：传统的<code>“Hello, world!”</code>程序。我将带您了解这个简单程序的各个方面，以及如何编译和运行C程序。</p>
<p>然后，我将讨论一些编辑器和编译器选项，并列出您在编写C代码时将快速熟悉的常见可移植性问题。</p>
<h3 id="开发您的第一个C程序"><a href="#开发您的第一个C程序" class="headerlink" title="开发您的第一个C程序"></a>开发您的第一个C程序</h3><p>学习C编程的最佳方式是开始编写C程序，传统上，我们从<code>“Hello, world!”</code>开始。要编写这个程序，您需要一个文本编辑器或集成开发环境（IDE），你可以在网上找到相关信息。</p>
<p>在您的文本编辑器中，输入程序：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单1-1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;                   </span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Hello, world!&quot;</span>);         </span><br><span class="line">	<span class="keyword">return</span> EXIT_SUCCESS;           </span><br><span class="line">&#125;                                  </span><br></pre></td></tr></table></figure>

<p>我们稍后将详细讨论这个程序的每一行。现在，请将这个文件保存为<code>hello.c</code>。<br>文件扩展名<code>.c</code>表示该文件包含C语言源代码。</p>
<h3 id="编译和运行您的程序"><a href="#编译和运行您的程序" class="headerlink" title="编译和运行您的程序"></a>编译和运行您的程序</h3><p>接下来，我们需要编译和运行程序，这涉及到两个单独的步骤。您可以选择众多的C编译器，而编译程序的命令取决于您使用的编译器。<br>在Linux和其他类似Unix的操作系统上，您可以使用<code>cc</code>命令调用系统编译器。要编译您的程序，请在命令行中输入<code>cc</code>，然后跟上要编译的文件的名称：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">cc hello.c</span></span><br></pre></td></tr></table></figure>

<p>如果您正确输入了程序，编译命令将在与您的源代码相同的目录中创建一个名为<code>a.out</code>的新文件。使用<code>ls</code>命令检查您的目录，您应该会看到以下内容：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash"><span class="built_in">ls</span></span></span><br><span class="line">a.out  hello.c</span><br></pre></td></tr></table></figure>

<p><code>a.out</code>文件是可执行程序，您现在可以在命令行上运行它：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">./a.out</span></span><br><span class="line">Hello, world!</span><br></pre></td></tr></table></figure>

<p>如果一切正常，程序应该会在终端窗口中打印出<code>Hello, world!</code>。如果没有打印出来，请将清单1-1中的程序文本与您的程序进行比较，以确保它们相同。 <code>cc</code>命令有许多标志和编译器选项。例如，<code>-o file</code>标志允许您为可执行文件指定一个易记的名称，而不是<code>a.out</code>。以下编译器调用将可执行文件命名为<code>hello</code>：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">cc -o hello hello.c</span></span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">./hello</span></span><br><span class="line">Hello, world!</span><br></pre></td></tr></table></figure>

<p>现在我们将逐行检查<code>hello.c</code>程序。</p>
<h3 id="预处理指令"><a href="#预处理指令" class="headerlink" title="预处理指令"></a>预处理指令</h3><p>hello.c程序的前两行使用了<code>#include</code>预处理指令，它的行为相当于在它所在的位置替换了它所指定的文件内容。</p>
<p>我们引入了<code>&lt;stdio.h&gt;</code>和<code>&lt;stdlib.h&gt;</code>头文件，以便访问这些头文件中声明的函数，然后就可以从程序中调用这些函数。</p>
<p><code>puts</code>函数在<code>&lt;stdio.h&gt;</code>中声明，<code>EXIT_SUCCESS</code>宏在<code>&lt;stdlib.h&gt;</code>中定义。正如文件名所示：<code>&lt;stdio.h&gt;</code>包含了C标准I&#x2F;O函数的声明，而<code>&lt;stdlib.h&gt;</code>包含了通用实用函数的声明。</p>
<p>您需要引入您在程序中使用的任何库函数的声明。</p>
<h3 id="主函数"><a href="#主函数" class="headerlink" title="主函数"></a>主函数</h3><p>程序的主要部分，如前面的清单1-1所示，从以下部分开始：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br></pre></td></tr></table></figure>

<p>这行定义了在程序启动时调用的<code>main</code>函数。<code>main</code>函数定义了程序的主入口点，在命令行或另一个程序中调用程序后，程序会在托管环境中开始执行。</p>
<p>C定义了两种可能的执行环境：独立环境和托管环境。独立环境可能不提供操作系统，通常用于嵌入式编程。这些实现提供了一组最小的库函数，并且在程序启动时调用的函数的名称和类型是由实现定义的。本书主要假设使用托管环境。</p>
<p>我们定义<code>main</code>函数返回<code>int</code>类型的值，并在括号内放置<code>void</code>，以指示该函数不接受参数。<code>int</code>类型是一种带符号的整数类型，可以用来表示正数、负数以及零。</p>
<p>与其他过程式语言类似，C程序由可以接受参数并返回值的过程（称为函数）组成。每个函数都是可重复使用的工作单元，在程序中可以根据需要多次调用。</p>
<p>在这种情况下，<code>main</code>函数返回的值表示程序是否成功终止。这个特定函数执行的实际工作是打印出<code>Hello, world!</code>这一行：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Hello, world!&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><code>puts</code>函数是C标准库中的一个函数，它将一个字符串参数写入<code>stdout</code>，通常表示控制台或终端窗口，并在输出中附加一个换行字符。<code>&quot;Hello, world!&quot;</code>是一个字符串字面量，它的行为类似于一个只读字符串。这个函数调用将<code>Hello, world!</code>输出到终端。</p>
<p>一旦您的程序完成，您会希望它退出。您可以使用<code>return</code>语句在<code>main</code>函数中返回一个整数值给主机环境或调用脚本来退出程序：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> EXIT_SUCCESS;</span><br></pre></td></tr></table></figure>

<p><code>EXIT_SUCCESS</code>是一个类似对象的宏，通常扩展为<code>0</code>，并且通常定义如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> EXIT_SUCCESS 0</span></span><br></pre></td></tr></table></figure>

<p>每个<code>EXIT_SUCCESS</code>都会被替换为<code>0</code>，然后从<code>main</code>返回给托管环境。调用程序的脚本可以检查其状态，以确定调用是否成功。</p>
<p><code>main</code>函数给托管环境返回一个值的过程相当于调用C标准库的<code>exit</code>函数，并将其参数设置为<code>main</code>函数的返回值。</p>
<p>这个程序的最后一行是一个右花括号<code> &#125;</code>，它关闭了我们从<code>main</code>函数的声明开始的代码块：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">	<span class="comment">//省略</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>您可以将左花括号放在同一行上，也可以独立成行，如下所示：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//省略</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个决定严格来说是一种风格上的选择，因为空白字符（包括换行符）通常在语法上没有意义。在本书中，我通常将左花括号放在与函数声明同一行上，因为这样在风格上更加紧凑。</p>
<h3 id="检查函数返回值"><a href="#检查函数返回值" class="headerlink" title="检查函数返回值"></a>检查函数返回值</h3><p>函数通常会返回一个计算结果或表示函数是否成功完成其任务的值。例如，我们在<code>“Hello, world!”</code>程序中使用的<code>puts</code>函数接受一个要打印的字符串，并返回一个<code>int</code>类型的值。如果发生写入错误，<code>puts</code>函数将返回宏<code>EOF</code>的值（一个负整数）；否则，它将返回一个非负整数值。</p>
<p>虽然<code>puts</code>函数对于我们的简单程序来说可能不太可能失败并返回<code>EOF</code>，但这是可能的。因为<code>puts</code>调用可能会失败并返回<code>EOF</code>，这意味着你的第一个C程序存在一个bug，或者至少可以改进如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">puts</span>(<span class="string">&quot;Hello, world!&quot;</span>) == EOF) &#123;</span><br><span class="line"><span class="keyword">return</span> EXIT_FAILURE;</span><br><span class="line"><span class="comment">// 此处的代码永远不会被执行</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line"><span class="comment">// 此处的代码永远不会被执行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个修改版的<code>“Hello, world!”</code>程序检查<code>puts</code>调用是否返回<code>EOF</code>，表示写入错误。如果函数返回<code>EOF</code>，程序将返回<code>EXIT_FAILURE</code>宏的值（非零）。否则，函数成功，程序将返回<code>EXIT_SUCCESS</code>（必须为<code>0</code>）。调用程序的脚本可以检查程序的状态以确定是否成功。</p>
<p><code>return</code>语句后面的代码是永远不会执行的死代码，这在修订后的程序中由单行注释表示。<code>//</code>后面的所有内容都会被编译器忽略。</p>
<h3 id="格式化输出"><a href="#格式化输出" class="headerlink" title="格式化输出"></a>格式化输出</h3><p><code>puts</code>函数是将字符串写入<code>stdout</code>的一种简单方式，但最终您可能需要使用<code>printf</code>函数来打印格式化的输出，例如，以打印字符串之外的参数。</p>
<p><code>printf</code>函数接受一个格式字符串，该字符串定义了输出的格式，然后是可变数量的参数，这些参数是您要打印的实际值。</p>
<p>例如，如果您想要使用<code>printf</code>函数来打印<code>Hello, world!</code>，可以这样写：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, <span class="string">&quot;Hello, world!&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>第一个参数是格式字符串<code>&quot;%s\n&quot;</code>。</p>
<p><code>%s</code>是一个转换说明，指示<code>printf</code>函数读取第二个参数（一个字符串字面值）并将其打印到<code>stdout</code>。</p>
<p><code>\n</code>是一个字母转义序列，用于表示非图形字符，并告诉函数在字符串之后包含一个换行符。如果没有换行序列，下一个被打印的字符（可能是命令提示符）将出现在同一行上。</p>
<p>这个函数调用输出以下内容：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello, world!</span><br></pre></td></tr></table></figure>

<p>要小心不要将用户提供的数据作为<code>printf</code>函数的第一个参数的一部分传递，因为这样做可能会导致格式化输出的安全漏洞（Seacord 2013）。</p>
<p>输出字符串的最简单方法是使用<code>puts</code>函数，如前所示。如果您在修订版的<code>“Hello, world!”</code>程序中使用<code>printf</code>而不是<code>puts</code>，您会发现它不再起作用，因为<code>printf</code>函数返回的状态与<code>puts</code>函数不同。如果成功，<code>printf</code>函数返回打印的字符数，如果发生输出或编码错误，则返回负值。您可以尝试修改<code>“Hello, world!”</code>程序以使用<code>printf</code>函数作为练习。</p>
<h3 id="编辑器和集成开发环境"><a href="#编辑器和集成开发环境" class="headerlink" title="编辑器和集成开发环境"></a>编辑器和集成开发环境</h3><p>可以使用各种编辑器和集成开发环境（IDE）来开发C程序。可用的确切工具取决于您使用的系统。</p>
<h3 id="编译器"><a href="#编译器" class="headerlink" title="编译器"></a>编译器</h3><p>许多C编译器可供选择，因此我不会在这里讨论它们所有。不同的编译器实现不同版本的C标准。许多嵌入式系统的编译器仅支持C89&#x2F;C90。流行的Linux和Windows编译器更努力地支持C标准的现代版本，包括对C2x的支持。</p>
<h3 id="可移植性"><a href="#可移植性" class="headerlink" title="可移植性"></a>可移植性</h3><p>每个C编译器实现都会有一些不同。编译器不断发展，因此，例如，像GCC这样的编译器可能会全面支持C17，但正在努力支持C2x，因此它可能已经实现了一些C2x的特性，但还没有实现其他特性。因此，编译器支持各种C标准版本（包括中间版本）。C实现的整体演进较慢，许多编译器明显落后于C标准。</p>
<p>如果一个程序只使用标准规范中指定的语言和库的特性，那么可以认为它是严格符合规范的。这些程序旨在实现最大的可移植性。然而，由于不同编译器的实现行为差异，没有现实世界的C程序是严格符合规范的，也永远不会是（可能也不应该是）。相反，C标准允许你编写符合规范的程序，这些程序可能依赖于非可移植的语言和库特性。</p>
<p>通常的做法是针对单个参考实现编写代码，或者有时根据计划部署代码的平台编写多个实现。C标准确保这些实现不会有太大的差异，并允许你同时面向多个实现，而无需每次都学习一种新的语言。</p>
<p>C标准文档的附录J列举了五种可移植性问题，它们包括：</p>
<ul>
<li><p>实现定义行为<br>实现定义行为（Implementation-defined behavior）是指C语言标准未明确定义的程序行为，这些行为在不同的C语言实现中可能产生不同的结果，但在同一实现中有一致的、有文档记录的行为。例如，一个实现定义行为是字节中的位数。</p>
<p>实现定义行为通常是无害的，但在移植到不同的实现时可能导致问题。因此，在编写代码时，尽量避免依赖于可能在不同的C实现中有所不同的实现定义行为。C语言标准的附录J.3中列举了一份完整的实现定义行为清单，程序员可以通过使用static_assert声明来记录对这些实现定义行为的依赖关系。</p>
<p>在本书中，会在代码中有实现定义行为的情况下进行说明，以帮助程序员了解潜在的问题和可移植性考虑。</p>
</li>
<li><p>未指定行为<br>未指定行为（Unspecified behavior）是指C语言标准为某些程序行为提供了两种或更多的选项，但标准不规定在任何情况下选择哪个选项。这意味着同一表达式的不同执行可能会产生不同的结果或产生不同的值。例如，函数参数的存储布局就是一种未指定行为，它在同一程序内的不同函数调用之间可以变化。在编写代码时，应避免依赖于C语言标准附录J.1中列举的未指定行为，因为这些行为可能在不同的C语言实现中表现不同。</p>
<p>未指定行为通常是为了给编译器和实现提供一定的灵活性，以便进行性能优化或其他目的。因此，在编写代码时，最好不要依赖于未指定行为，以确保代码的可移植性和稳定性。</p>
</li>
<li><p>未定义行为<br>未定义行为（Undefined behavior）是指C语言标准未定义的行为，或者更具体地说，是指在使用非可移植或错误的程序构造或错误的数据时，标准不对其行为做出任何规定的情况。未定义行为的示例包括有符号整数溢出和解引用无效指针值。具有未定义行为的代码通常是错误的，但情况比较复杂。标准中标识了未定义行为，如下所示：</p>
<ul>
<li><p>当违反了“shall”（应当）或“shall not”（不得）的要求，且该要求出现在约束之外时，行为是未定义的。</p>
</li>
<li><p>当行为被明确指定为“undefined behavior”（未定义行为）时</p>
</li>
<li><p>对某个行为没有明确的定义</p>
</li>
</ul>
<p>前两种未定义行为通常被称为显式未定义行为，而第三种被称为隐式未定义行为。这三者之间在强调上没有区别；它们都描述了未定义的行为。C标准的附录J.2，“未定义行为”，列举了C中明确定义为显式未定义行为的行为。开发人员经常误解未定义行为为C标准中的错误或遗漏，但将某种行为分类为未定义是有意而慎重的决定。C标准委员会将行为分类为未定义，以实现以下目标：</p>
<ul>
<li><p>给予实现者不捕获难以诊断的程序错误的许可</p>
</li>
<li><p>避免定义模糊的边缘情况，以免偏向某种实现策略而不是另一种</p>
</li>
<li><p>确定可能的符合性语言扩展领域，在这些领域中，实现者可以通过提供官方未定义行为的定义来增强语言</p>
</li>
</ul>
<p>这三个原因实际上非常不同，但都被视为可移植性问题。随着本书的进行，我们将检查这三种情况的示例。编译器（实现）有以下自由：</p>
<ul>
<li><p>完全忽略未定义行为，导致不可预测的结果</p>
</li>
<li><p>以环境特性的文档方式行为（无论是否发出诊断）</p>
</li>
<li><p>终止翻译或执行（并发出诊断）</p>
</li>
</ul>
<p>这些选项都不是很好（特别是第一个选项），因此最好避免未定义行为，除非实现明确指定了这些行为被定义为允许您调用语言扩展。（编译器有时会有一个严格模式，可以帮助通知程序员这些可移植性问题。）</p>
</li>
<li><p>地区特定行为和常见扩展</p>
<p>“地区特定行为”依赖于每个C语言实现所记录的国籍、文化和语言的本地习惯。而”常见扩展”则是许多系统中广泛使用但不一定可在所有实现中移植的功能或行为。</p>
</li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>在本章中，您学习了如何编写一个简单的C语言程序，编译它并运行它。</p>
<p>我们在本章中还讨论了C语言程序的可移植性。</p>
<p>接下来的章节将详细探讨C语言和库的特定特性，从下一章开始介绍对象、函数和类型。</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/NihilDigit">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E6%82%A8%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAC%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.</span> <span class="toc-text">开发您的第一个C程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%92%8C%E8%BF%90%E8%A1%8C%E6%82%A8%E7%9A%84%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.</span> <span class="toc-text">编译和运行您的程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E5%A4%84%E7%90%86%E6%8C%87%E4%BB%A4"><span class="toc-number">3.</span> <span class="toc-text">预处理指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E5%87%BD%E6%95%B0"><span class="toc-number">4.</span> <span class="toc-text">主函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-number">5.</span> <span class="toc-text">检查函数返回值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%BE%93%E5%87%BA"><span class="toc-number">6.</span> <span class="toc-text">格式化输出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E5%99%A8%E5%92%8C%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">7.</span> <span class="toc-text">编辑器和集成开发环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%99%A8"><span class="toc-number">8.</span> <span class="toc-text">编译器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%80%A7"><span class="toc-number">9.</span> <span class="toc-text">可移植性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">10.</span> <span class="toc-text">总结</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&text=EffectiveC_01_开始使用C"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&title=EffectiveC_01_开始使用C"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&is_video=false&description=EffectiveC_01_开始使用C"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=EffectiveC_01_开始使用C&body=Check out this article: https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&title=EffectiveC_01_开始使用C"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&title=EffectiveC_01_开始使用C"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&title=EffectiveC_01_开始使用C"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&title=EffectiveC_01_开始使用C"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&name=EffectiveC_01_开始使用C&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://blog.nihildigit.one/2024/02/01/EffectiveC-01-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8C/&t=EffectiveC_01_开始使用C"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024
    NihilDigit
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/NihilDigit">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
